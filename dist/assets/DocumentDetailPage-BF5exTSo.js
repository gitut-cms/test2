import{b as L,a as M,u as A,c as F,r as c,C as P,j as e,F as k,P as R,e as B}from"./index-DgmZNK3x.js";import{S as O}from"./SocialShareButtons-BKLyRpAE.js";import{A as S}from"./AdBanner-BHXyFlzY.js";const o=(r,u,d=!0)=>{const g=d?`meta[property='${r}']`:`meta[name='${r}']`;let a=document.querySelector(g);a||(a=document.createElement("meta"),a.setAttribute(d?"property":"name",r),document.head.appendChild(a)),a.setAttribute("content",u)},V=()=>{const{countryCode:r,slug:u}=L(),d=M(),{services:g,siteSettings:a,loading:v}=A(),{language:p,t:T}=F(),[t,w]=c.useState(null),[$,x]=c.useState(!0),y=c.useMemo(()=>{var s,i;return((i=(s=P[p])==null?void 0:s.find(n=>n.code===r))==null?void 0:i.name)||r},[p,r]),f=c.useMemo(()=>t?`تحميل و استخراج ${t.name} في ${y}`:"Gitut",[t,y]),_=c.useMemo(()=>{if(!t||!("description"in t)||!t.description)return"<p>لا يوجد وصف متاح لهذا المستند.</p>";const s=t.description,i=`<div class="my-6 p-4 bg-blue-50 border-l-4 border-blue-400 text-blue-800 rounded-md" role="alert">
            <p class="font-bold">ملاحظة هامة</p>
            <p>أزرار معاينة وتحميل أو تعبئة هذا المستند موجودة في <strong>أسفل هذه الصفحة</strong>.</p>
        </div>`,n=s.indexOf("</p>");return n!==-1?s.slice(0,n+4)+i+s.slice(n+4):i+s},[t]);c.useEffect(()=>{var s,i;if(t&&a){const n=((s=a.seo)==null?void 0:s[r||"dz"])||((i=a.seo)==null?void 0:i.default),l=`${f} ${n.titleSeparator} ${n.siteName}`,m="description"in t&&t.description?t.description.replace(/<[^>]*>/g,""):"",b=m?m.substring(0,160)+(m.length>160?"...":""):n.metaDescription,j="https://datas.gitut.com/data/image/gitut-og-main.png",D=p==="ar"?"ar_AR":p==="fr"?"fr_FR":"en_US";document.title=l,o("description",b,!1),o("og:title",l),o("og:description",b),o("og:image",j),o("og:image:secure_url",j),o("og:image:width","1200"),o("og:image:height","630"),o("og:url",window.location.href),o("og:type","website"),o("og:site_name",n.siteName),o("og:locale",D),o("twitter:card","summary_large_image",!1),o("twitter:url",window.location.href,!1),o("twitter:title",l,!1),o("twitter:description",b,!1),o("twitter:image",j,!1)}},[t,a,r,p,f]),c.useEffect(()=>{(async()=>{if(!u){x(!1);return}if(v)return;x(!0);let i=null;const n=g.find(l=>l.slug===u&&(l.serviceType==="doc"||l.serviceType==="static-doc"));n?i=n:i=null,i&&i.countryCode&&i.countryCode!==r?w(null):w(i),x(!1)})()},[u,g,v,r]);const N=c.useMemo(()=>{if(!(t!=null&&t.tags))return[];const s=t.tags.split(",").map(i=>i.trim().toLowerCase()).filter(Boolean);return s.length===0?[]:g.filter(i=>{var l;return i.id===t.id?!1:(((l=i.tags)==null?void 0:l.split(",").map(m=>m.trim().toLowerCase()).filter(Boolean))||[]).some(m=>s.includes(m))}).slice(0,5)},[t,g]);if($)return e.jsx("div",{className:"flex justify-center items-center p-10",children:e.jsx(k,{className:"animate-spin text-4xl text-green-600"})});if(!t)return e.jsxs("div",{className:"text-center py-20",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4",children:"لم يتم العثور على المستند"}),e.jsx("button",{onClick:()=>d(`/${r}/services`),className:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700",children:"العودة إلى قائمة الخدمات"})]});const C=t.serviceType==="doc",E=C||t.serviceType==="static-doc",h=t.slug||t.id,I=()=>{const s=!t.countryCode||t.countryCode==="global",i=s?"/go-to-site/internal-form":`/${r}/go-to-site/internal-form`,n=s?`/public-form/${h}`:`/${r}/public-form/${h}`;d(i,{state:{targetUrl:n,siteName:`تعبئة نموذج: ${t.name}`}})};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-8 flex-grow",children:[e.jsxs("main",{className:"md:col-span-3 bg-white rounded-lg shadow-xl p-6 md:p-8 flex flex-col",children:[e.jsxs("div",{className:"flex-grow",children:[e.jsx("header",{className:"mb-6 border-b pb-4",children:e.jsx("h1",{className:"text-4xl font-bold text-gray-900",children:f})}),e.jsx("div",{className:"prose prose-lg max-w-none text-gray-800",dangerouslySetInnerHTML:{__html:_}}),e.jsx("div",{className:"my-6",children:e.jsx(S,{placement:"SERVICE_DETAIL_MAIN_TOP"})})]}),e.jsxs("div",{className:"mt-8 pt-6 border-t",children:[e.jsx("div",{className:"mb-6",children:e.jsx(S,{placement:"SERVICE_DETAIL_MAIN_BOTTOM"})}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[E&&e.jsxs("button",{onClick:()=>d(`/${r}/view/${h}`),className:"flex items-center justify-center gap-3 w-full md:w-auto bg-red-600 text-white font-bold py-3 px-8 rounded-lg hover:bg-red-700 transition-colors",children:[e.jsx(R,{}),e.jsx("span",{children:"معاينة"})]}),C&&e.jsxs("button",{onClick:I,className:"flex items-center justify-center gap-3 w-full md:w-auto bg-green-600 text-white font-bold py-3 px-8 rounded-lg hover:bg-green-700 transition-colors",children:[e.jsx(B,{}),e.jsx("span",{children:"تعبئة/تحميل"})]})]})]})]}),e.jsx("aside",{className:"md:col-span-1 space-y-6",children:N.length>0&&e.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-lg border",children:[e.jsx("h3",{className:"font-bold text-lg mb-3 text-gray-800",children:T("relatedServices.title")}),e.jsx("div",{className:"space-y-3",children:N.map(s=>{const i=s.slug||s.id,n=s.serviceType==="site"?`/${r}/site/${i}`:`/${r}/doc/${i}`;return e.jsxs("button",{onClick:()=>d(n),className:"w-full text-right block p-3 bg-gray-50 rounded-md border hover:border-green-400 hover:bg-green-50 transition-all",children:[e.jsx("p",{className:"font-semibold text-gray-900",children:s.name}),e.jsx("div",{className:"mt-1 prose prose-sm max-w-none line-clamp-2 compact-prose",dangerouslySetInnerHTML:{__html:"description"in s&&s.description?s.description:""}})]},s.id)})})]})})]}),e.jsx(O,{url:window.location.href,title:f,description:"description"in t&&t.description?t.description:""})]})};export{V as default};
