import{r as d,c as C,aN as c,j as e}from"./index-DgmZNK3x.js";import{F as g}from"./constants-DfStgaks.js";import{I as F}from"./ImageCapture-Crup5CAt.js";import{S as O}from"./SpeechRecognitionControl-BM9TYsD7.js";import{c as S}from"./fileUtils-Cb1IM2ig.js";import"./geminiService-CD7J7Ty3.js";const R=()=>{const[h,u]=d.useState([]),[n,m]=d.useState({isOpen:!1,mode:"create",client:null}),[o,x]=d.useState({}),{t:l}=C();d.useEffect(()=>{c.getAll().then(u)},[]);const p=()=>{c.getAll().then(u)},j=()=>{x({}),m({isOpen:!0,mode:"create",client:null})},f=s=>{x({...s}),m({isOpen:!0,mode:"edit",client:s})},b=()=>{m({isOpen:!1,mode:"create",client:null})},i=(s,a)=>{x(r=>({...r,[s]:a}))},N=d.useMemo(()=>Object.values(g).map(s=>({id:s.id,label:l(s.label)})),[l]),y=s=>{s.forEach(({fieldId:a,value:r})=>{i(a,r)})},v=s=>{s.preventDefault(),n.mode==="create"?c.create(o):n.client&&c.update(n.client.id,o),p(),b()},w=s=>{window.confirm("هل أنت متأكد من أنك تريد حذف هذا الزبون؟ لا يمكن التراجع عن هذا الإجراء.")&&(c.delete(s),p())};return e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:"إدارة الزبائن"}),e.jsx("button",{onClick:j,className:"bg-blue-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-blue-700 transition-colors",children:"+ إضافة زبون جديد"})]}),e.jsx("div",{className:"bg-white p-2 rounded-lg border shadow-sm",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-right",children:[e.jsx("thead",{className:"bg-gray-50 border-b",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-3 font-semibold text-sm text-gray-600",children:"الاسم الكامل"}),e.jsx("th",{className:"p-3 font-semibold text-sm text-gray-600",children:"رقم الهاتف"}),e.jsx("th",{className:"p-3 font-semibold text-sm text-gray-600",children:"البريد الإلكتروني"}),e.jsx("th",{className:"p-3 font-semibold text-sm text-gray-600",children:"إجراءات"})]})}),e.jsx("tbody",{children:h.length>0?h.map(s=>e.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[e.jsx("td",{className:"p-3 text-gray-800 font-semibold",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("img",{src:S(s.profilePicture)||`https://ui-avatars.com/api/?name=${s.fullName||"NN"}&background=random`,alt:s.fullName||"Client",className:"w-10 h-10 rounded-full object-cover"}),e.jsx("span",{children:s.fullName||"-"})]})}),e.jsx("td",{className:"p-3 text-gray-600",children:s.phone||"-"}),e.jsx("td",{className:"p-3 text-gray-600",children:s.email||"-"}),e.jsxs("td",{className:"p-3 space-x-4 space-x-reverse",children:[e.jsx("button",{onClick:()=>f(s),className:"text-blue-600 hover:underline text-sm font-semibold",children:"تعديل"}),e.jsx("button",{onClick:()=>w(s.id),className:"text-red-600 hover:underline text-sm font-semibold",children:"حذف"})]})]},s.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"text-center p-6 text-gray-500",children:'لا يوجد زبائن محفوظون. انقر على "إضافة زبون جديد" للبدء.'})})})]})})}),n.isOpen&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center p-4",children:e.jsx("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-2xl",children:e.jsxs("form",{onSubmit:v,children:[e.jsx("div",{className:"p-6 border-b",children:e.jsx("h2",{className:"text-2xl font-bold",children:n.mode==="create"?"إضافة زبون جديد":"تعديل بيانات الزبون"})}),e.jsxs("div",{className:"p-6 space-y-4 max-h-[70vh] overflow-y-auto",children:[e.jsx(O,{formFields:N,onFieldUpdate:y}),Object.values(g).map(s=>{var r;if(!s)return null;const a=s.id;return e.jsxs("div",{children:[e.jsx("label",{htmlFor:s.id,className:"block text-sm font-medium text-gray-700 mb-1",children:l(s.label)}),s.type==="file"?e.jsx(F,{value:o[a]||"",onChange:t=>i(a,t)}):s.type==="select"?e.jsxs("select",{id:s.id,name:s.id,value:o[a]||"",onChange:t=>i(t.target.name,t.target.value),className:"block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-green-500 focus:border-green-500",children:[e.jsx("option",{value:"",children:l(s.placeholder)}),(r=s.options)==null?void 0:r.map(t=>e.jsx("option",{value:t.value,children:l(t.label)},t.value))]}):e.jsx("input",{type:s.type,id:s.id,name:s.id,value:o[a]||"",onChange:t=>i(t.target.name,t.target.value),placeholder:l(s.placeholder)||"",className:"block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-green-500 focus:border-green-500"})]},s.id)})]}),e.jsxs("div",{className:"px-6 py-4 bg-gray-50 flex justify-end gap-3",children:[e.jsx("button",{type:"button",onClick:b,className:"bg-gray-200 text-gray-800 font-bold py-2 px-4 rounded-lg hover:bg-gray-300",children:"إلغاء"}),e.jsx("button",{type:"submit",className:"bg-green-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-green-700",children:"حفظ"})]})]})})})]})};export{R as default};
