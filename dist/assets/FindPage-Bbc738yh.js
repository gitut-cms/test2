import{u as J,a as W,b as Y,c as q,r as l,C as I,j as e,F as K,d as C,e as z,f as X,g as Z,h as ee,i as R,k as te,l as L,m as se}from"./index-hpjxKmld.js";const b=x=>x?x.replace(/[أإآ]/g,"ا").replace(/ة/g,"ه"):"",ae=()=>{const{services:x,loading:j}=J(),y=W(),{countryCode:c}=Y(),{t:n,language:g}=q(),a=!c,[E,u]=l.useState(!1),h=l.useMemo(()=>[{title:a?"Gitut: مساعدك لإنجاز الوثائق عالمياً":n("findPage.hero.title1"),subtitle:a?"اختر بلدك للوصول إلى الخدمات المحلية ومقاهي الإنترنت المعتمدة.":n("findPage.hero.subtitle1")},{title:a?"خدمات المستندات في متناول يدك":n("findPage.hero.title2"),subtitle:a?"نربطك بأفضل مراكز الخدمات في بلدك لضمان جودة وسرعة الإنجاز.":n("findPage.hero.subtitle2")}],[n,a]),[v,V]=l.useState(0),A=l.useMemo(()=>I[g]||I.ar,[g]),w=l.useMemo(()=>a?x:x.filter(t=>!t.countryCode||t.countryCode===c),[x,c,a]);l.useEffect(()=>{if(j)return;const t=setInterval(()=>{V(s=>(s+1)%h.length)},7e3);return()=>clearInterval(t)},[h.length,j]);const[d,N]=l.useState(""),[k,m]=l.useState([]),[B,F]=l.useState(!1),[i,T]=l.useState([]),[P,D]=l.useState(!1),f=l.useRef(null),M=window.SpeechRecognition||window.webkitSpeechRecognition,p=!!M;l.useEffect(()=>{if(a)if(d.trim()){const t=b(d.toLowerCase()),s=w.filter(r=>b(r.name.toLowerCase()).includes(t)).map(r=>({...r,type:"service"}));m(s)}else m([]);else if(d.trim()){const t=b(d.toLowerCase()),s=w.filter(r=>b(r.name.toLowerCase()).includes(t)).map(r=>({...r,type:"service"}));m(s)}else m([])},[d,w,a]),l.useEffect(()=>{if(!p||a)return;const t=new M;t.continuous=!1,t.interimResults=!1;let s="ar-SA";switch(g){case"en":s="en-US";break;case"fr":s="fr-FR";break;case"de":s="de-DE";break;case"es":s="es-ES";break;case"tr":s="tr-TR";break;case"ja":s="ja-JP";break}return t.lang=s,t.onresult=r=>N(r.results[0][0].transcript),t.onerror=r=>{console.error("Speech recognition error",r.error)},t.onend=()=>D(!1),f.current=t,()=>{var r;return(r=f.current)==null?void 0:r.abort()}},[p,g,a]);const G=()=>{var t,s;if(!p){alert("Your browser does not support voice search.");return}P?(t=f.current)==null||t.stop():((s=f.current)==null||s.start(),D(!0))},Q=t=>{N(""),i.find(s=>s.id===t.id&&s.serviceType===t.serviceType)||T(s=>[...s,t])},U=(t,s)=>{T(r=>r.filter(o=>!(o.id===t&&o.serviceType===s)))},$=t=>{t.preventDefault();const s=i.filter(o=>o.serviceType==="doc"||o.serviceType==="site");if(s.length===0){a?u(!0):alert(n("findPage.alert.selectFillable"));return}const r=s.map(o=>o.id);y(`/${c||"dz"}/find-cafe`,{state:{documentIds:r}})},O=()=>{if(i.length!==1)return;const t=i[0],s=t.slug||t.id,r=!t.countryCode||t.countryCode==="global",o=r?"/go-to-site/internal-form":`/${c||"dz"}/go-to-site/internal-form`,H=r?`/public-form/${s}`:`/${c||"dz"}/public-form/${s}`;y(o,{state:{targetUrl:H,siteName:`تعبئة نموذج: ${t.name}`}})},_=t=>{u(!1),y(`/${t}/`)},S=i.filter(t=>t.serviceType==="doc"||t.serviceType==="site").length;return e.jsxs("div",{className:"space-y-8",children:[e.jsx("section",{className:"text-center p-8 md:p-10 bg-white rounded-xl shadow-lg overflow-hidden flex flex-col justify-center min-h-[12rem]",children:j?e.jsx("div",{className:"flex justify-center",children:e.jsx(K,{className:"animate-spin text-green-600 text-2xl"})}):e.jsxs("div",{className:"fade-in-text",children:[e.jsx("h1",{className:"text-3xl md:text-4xl font-bold text-gray-900 mb-2",children:h[v].title}),e.jsx("p",{className:"text-base md:text-lg text-gray-700 max-w-3xl mx-auto",children:h[v].subtitle})]},v+(a?"g":"l"))}),e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 space-y-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:a?"ابدأ باختيار بلدك أو ابحث عن مستند":n("findPage.step1.title")}),e.jsx("form",{onSubmit:$,children:e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute right-4 top-1/2 -translate-y-1/2 text-gray-400 pointer-events-none",children:a?e.jsx(C,{className:"h-5 w-5"}):e.jsx(z,{className:"h-5 w-5"})}),e.jsx("input",{type:"text",placeholder:a?"اختر بلدك أو ابحث عن خدمة للبدء...":n("findPage.step1.placeholder"),value:d,onChange:t=>N(t.target.value),onFocus:()=>{a&&!d?u(!0):F(!0)},onBlur:()=>setTimeout(()=>F(!1),200),className:"p-4 pr-12 pl-14 bg-white border border-gray-300 rounded-md w-full focus:outline-none focus:ring-2 focus:ring-green-500 text-lg shadow-inner"}),p&&!a&&e.jsx("button",{type:"button",onClick:G,title:n("findPage.step1.voiceSearchTitle"),className:`absolute left-3 top-1/2 -translate-y-1/2 p-3 rounded-full transition-colors duration-300 ${P?"bg-red-500 text-white animate-pulse":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:e.jsx(X,{className:"h-5 w-5"})}),a&&e.jsx("button",{type:"button",onClick:()=>u(!0),className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 p-3 hover:text-green-600 transition-colors",title:"اختر الدولة",children:e.jsx(Z,{className:"h-4 w-4"})}),B&&k.length>0&&e.jsx("ul",{className:"absolute top-full left-0 right-0 mt-1 bg-white border border-gray-300 rounded-md shadow-2xl z-50 max-h-80 overflow-y-auto divide-y",children:k.map((t,s)=>e.jsxs("li",{className:"px-4 py-3 cursor-pointer hover:bg-green-50 flex justify-between items-center transition-colors",onMouseDown:()=>Q(t),children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ee,{className:"text-green-600"}),e.jsx("span",{className:"text-gray-700",children:t.name})]}),e.jsx(R,{className:"text-gray-300 text-xs"})]},`s-${t.id}-${s}`))})]})})]}),e.jsx("section",{children:i.length>0?e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 space-y-4",children:[e.jsxs("h3",{className:"text-xl font-semibold",children:[n("findPage.selectedDocs.title")," (",i.length,"):"]}),e.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto pr-2",children:i.map(t=>{const s="description"in t?t.description:"url"in t?t.url:"",r=t.serviceType==="static-doc"?e.jsx(te,{className:"h-6 w-6 text-blue-500 flex-shrink-0 mt-1"}):t.serviceType==="site"?e.jsx(C,{className:"h-6 w-6 text-indigo-500 flex-shrink-0 mt-1"}):e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-green-600 flex-shrink-0 mt-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})});return e.jsxs("article",{className:"bg-gray-50 rounded-lg p-3 border flex justify-between items-center gap-3",children:[e.jsxs("div",{className:"flex items-start gap-3 flex-grow",children:[r,e.jsxs("div",{className:"flex-grow",children:[e.jsx("h4",{className:"text-md font-bold text-gray-900",children:t.name}),e.jsx("div",{className:"text-sm text-gray-600 prose prose-sm max-w-none line-clamp-2",dangerouslySetInnerHTML:{__html:s}})]})]}),e.jsxs("div",{className:"flex items-center gap-3 flex-shrink-0",children:[t.serviceType==="static-doc"&&e.jsx("a",{href:`/${c||"dz"}/view/${t.id}`,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline text-sm font-semibold whitespace-nowrap",children:n("findPage.selectedDocs.viewFile")}),e.jsx("button",{onClick:()=>U(t.id,t.serviceType),title:n("findPage.selectedDocs.removeTitle"),className:"text-red-500 hover:text-red-700 p-1 rounded-full hover:bg-red-100",children:e.jsx(L,{})})]})]},`${t.serviceType}-${t.id}`)})}),e.jsxs("form",{onSubmit:$,className:"text-center pt-4 flex flex-col sm:flex-row justify-center gap-4",children:[i.length===1&&e.jsxs("button",{type:"button",onClick:O,className:"flex items-center justify-center gap-2 bg-red-600 text-white font-bold py-3 px-8 rounded-lg hover:bg-red-700 transition-colors",children:[e.jsx(z,{}),e.jsx("span",{children:"التالي: تعبئة المستند (1)"})]}),e.jsxs("button",{type:"submit",className:"flex items-center justify-center gap-2 bg-green-600 text-white font-bold py-3 px-8 rounded-lg hover:bg-green-700 transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed",disabled:S===0,title:S===0?n("findPage.selectedDocs.nextStepButtonDisabledTitle"):"",children:[e.jsx("span",{children:n("findPage.selectedDocs.nextStepButton",{count:S})}),e.jsx(R,{})]})]})]}):e.jsx("div",{className:"text-center py-10 bg-white rounded-lg shadow",children:e.jsx("p",{className:"text-gray-600 text-lg",children:a?"ابدأ بالبحث عن مستند أو اختر بلدك أعلاه":n("findPage.selectedDocs.emptyState")})})}),E&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-[100] flex justify-center items-center p-4 animate-fadeIn",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-lg overflow-hidden transform transition-all scale-100",children:[e.jsxs("div",{className:"bg-green-600 p-6 text-white flex justify-between items-center",children:[e.jsxs("h3",{className:"text-xl font-bold flex items-center gap-2",children:[e.jsx(C,{}),e.jsx("span",{children:"اختر بلدك للمتابعة"})]}),e.jsx("button",{onClick:()=>u(!1),className:"hover:rotate-90 transition-transform p-2",children:e.jsx(L,{size:20})})]}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"relative mb-6",children:[e.jsx(se,{className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"ابحث عن بلدك...",className:"w-full p-3 pr-10 border rounded-lg focus:ring-2 focus:ring-green-500 outline-none",onChange:t=>{}})]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 max-h-[50vh] overflow-y-auto pr-1",children:A.map(t=>e.jsxs("button",{onClick:()=>_(t.code),className:"flex items-center gap-4 p-4 bg-gray-50 rounded-xl hover:bg-green-50 border border-transparent hover:border-green-200 transition-all text-right group",children:[e.jsx("span",{className:"text-3xl group-hover:scale-110 transition-transform",children:t.flag}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-bold text-gray-800",children:t.name}),e.jsx("span",{className:"text-xs text-gray-400",children:t.code.toUpperCase()})]})]},t.code))})]}),e.jsx("div",{className:"bg-gray-50 p-4 text-center text-xs text-gray-500",children:"سيتم توجيهك إلى صفحة الخدمات الخاصة بالبلد المختار"})]})})]})};export{ae as default};
