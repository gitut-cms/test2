import{u as w,r as m,bm as i,j as e,bn as S}from"./index-DgmZNK3x.js";const F=()=>{const{siteSettings:t}=w(),[s,p]=m.useState(t||i),[u,x]=m.useState(""),[D,C]=m.useState({current:"",new:"",confirm:""}),[g,b]=m.useState(!1);m.useEffect(()=>{if(t){const d={...i,...t,payment:{...i.payment,...t.payment||{}},pricing:{...i.pricing,...t.pricing||{}},seo:{...i.seo,...t.seo||{}},social:{...i.social,...t.social||{}},ads:{...i.ads,...t.ads||{}},ai:{...i.ai,...t.ai||{}}};p(d)}},[t]);const a=d=>{const{name:r,value:h,type:y,checked:v}=d.target,o=r.split("."),j=y==="checkbox"?v:y==="number"?parseFloat(h)||0:h;p(f=>{if(!f)return i;const n=JSON.parse(JSON.stringify(f));if(o.length===3){const[l,c,k]=o;n[l]||(n[l]={}),n[l][c]||(n[l][c]={}),n[l][c][k]=j}else if(o.length===2){const[l,c]=o;n[l]||(n[l]={}),n[l][c]=j}return n})},N=async d=>{if(d.preventDefault(),!!s){b(!0),x("");try{const r={payment:s.payment,pricing:s.pricing,ads:s.ads,ai:s.ai};await S(r),x("تم حفظ إعدادات الموقع بنجاح!")}catch(r){console.error("Error saving settings:",r),alert("حدث خطأ أثناء حفظ الإعدادات. تحقق من صلاحيات قاعدة البيانات.")}finally{b(!1),setTimeout(()=>x(""),5e3)}}};return s?e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-6",children:"الإعدادات العامة"}),u&&e.jsx("div",{className:"bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded-md relative mb-6",role:"alert",children:e.jsx("span",{className:"block sm:inline",children:u})}),e.jsxs("form",{onSubmit:N,className:"space-y-8 bg-white p-8 rounded-lg border",children:[e.jsxs("fieldset",{className:"border p-4 rounded-md",children:[e.jsx("legend",{className:"px-2 font-semibold text-lg text-gray-700",children:"إعدادات التسعير"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mt-4",children:[e.jsxs("div",{className:"space-y-2 p-3 bg-gray-50 rounded-md",children:[e.jsx("h3",{className:"font-medium text-gray-600",children:"إنشاء مستند ديناميكي"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-500",children:"السعر بالدينار"}),e.jsx("input",{type:"number",name:"pricing.dynamicDocument.dzd",value:s.pricing.dynamicDocument.dzd,onChange:a,className:"mt-1 block w-full p-2 border rounded-md"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-500",children:"السعر بالدولار"}),e.jsx("input",{type:"number",name:"pricing.dynamicDocument.usd",value:s.pricing.dynamicDocument.usd,onChange:a,className:"mt-1 block w-full p-2 border rounded-md"})]})]}),e.jsxs("div",{className:"space-y-2 p-3 bg-gray-50 rounded-md",children:[e.jsx("h3",{className:"font-medium text-gray-600",children:"تعبئة نموذج موقع"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-500",children:"السعر بالدينار"}),e.jsx("input",{type:"number",name:"pricing.siteFormFill.dzd",value:s.pricing.siteFormFill.dzd,onChange:a,className:"mt-1 block w-full p-2 border rounded-md"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-500",children:"السعر بالدولار"}),e.jsx("input",{type:"number",name:"pricing.siteFormFill.usd",value:s.pricing.siteFormFill.usd,onChange:a,className:"mt-1 block w-full p-2 border rounded-md"})]})]}),e.jsxs("div",{className:"space-y-2 p-3 bg-gray-50 rounded-md",children:[e.jsx("h3",{className:"font-medium text-gray-600",children:"تنزيل مستند ثابت"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-500",children:"السعر بالدينار"}),e.jsx("input",{type:"number",name:"pricing.staticDocumentDownload.dzd",value:s.pricing.staticDocumentDownload.dzd,onChange:a,className:"mt-1 block w-full p-2 border rounded-md"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-500",children:"السعر بالدولار"}),e.jsx("input",{type:"number",name:"pricing.staticDocumentDownload.usd",value:s.pricing.staticDocumentDownload.usd,onChange:a,className:"mt-1 block w-full p-2 border rounded-md"})]})]})]})]}),e.jsxs("fieldset",{className:"border p-4 rounded-md",children:[e.jsx("legend",{className:"px-2 font-semibold text-lg text-gray-700",children:"إعدادات الدفع"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mt-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"حساب CCP"}),e.jsx("input",{type:"text",name:"payment.ccp",value:s.payment.ccp,onChange:a,className:"mt-1 block w-full p-2 border rounded-md"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"BaridiMob (اسم ولقب)"}),e.jsx("input",{type:"text",name:"payment.baridiMob",value:s.payment.baridiMob,onChange:a,className:"mt-1 block w-full p-2 border rounded-md"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"بريد PayPal"}),e.jsx("input",{type:"email",name:"payment.paypalEmail",value:s.payment.paypalEmail,onChange:a,className:"mt-1 block w-full p-2 border rounded-md"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"سعر الصرف (1 USD = ? DZD)"}),e.jsx("input",{type:"number",name:"payment.exchangeRate",value:s.payment.exchangeRate,onChange:a,className:"mt-1 block w-full p-2 border rounded-md"})]}),e.jsx("div",{className:"md:col-span-2",children:e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",name:"payment.paypalEnabled",checked:s.payment.paypalEnabled,onChange:a,className:"h-4 w-4"}),e.jsx("span",{children:"تفعيل الدفع عبر PayPal (للمستخدمين الدوليين)"})]})})]})]}),e.jsxs("fieldset",{className:"border p-4 rounded-md",children:[e.jsx("legend",{className:"px-2 font-semibold text-lg text-gray-700",children:"إعدادات الذكاء الاصطناعي (Gemini)"}),e.jsxs("div",{className:"space-y-4 mt-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"مفتاح API الخاص بالمدير (Master Key)"}),e.jsx("input",{type:"password",name:"ai.apiKey",value:s.ai.apiKey||"",onChange:a,placeholder:"أدخل مفتاح Gemini API الخاص بك هنا",className:"mt-1 block w-full p-2 border rounded-md"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:'هذا المفتاح سيتم تخزينه في قاعدة البيانات. للحصول على أمان أعلى، يوصى بتعيين المفتاح كـ "secret" في بيئة Cloudflare Worker والذي ستكون له الأولوية على هذا الإعداد.'})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",name:"ai.useAdminKey",checked:s.ai.useAdminKey||!1,onChange:a,className:"h-4 w-4"}),e.jsx("span",{children:"استخدام مفتاح المدير لجميع المستخدمين"})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"عند تفعيل هذا الخيار، سيتم استخدام مفتاح المدير لجميع عمليات الذكاء الاصطناعي في المنصة، وسيتم تجاهل أي مفاتيح API يدخلها أصحاب المقاهي في إعداداتهم. هذا الخيار موصى به للتحكم المركزي في التكاليف والأمان."})]})]})]}),e.jsx("div",{className:"flex justify-end pt-6 border-t mt-8",children:e.jsx("button",{type:"submit",disabled:g,className:"bg-green-600 text-white font-bold py-3 px-8 rounded-lg hover:bg-green-700 transition-colors disabled:bg-gray-400",children:g?"جاري الحفظ...":"حفظ الإعدادات"})})]})]}):e.jsx("div",{children:"جاري تحميل الإعدادات..."})};export{F as default};
