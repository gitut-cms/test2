import{b as E,a as _,u as k,c as B,r as v,j as n,L as D}from"./index-DgmZNK3x.js";import{S as C}from"./SocialShareButtons-BKLyRpAE.js";import{A as R}from"./AdBanner-BHXyFlzY.js";const i=(u,f,x=!0)=>{const p=x?`meta[property='${u}']`:`meta[name='${u}']`;let d=document.querySelector(p);d||(d=document.createElement("meta"),d.setAttribute(x?"property":"name",u),document.head.appendChild(d)),d.setAttribute("content",f)},S=u=>u?u.replace(/[أإآ]/g,"ا").replace(/ة/g,"ه").toLowerCase():"",P=()=>{const{slug:u,lang:f}=E(),x=_(),{blogPosts:p,siteSettings:d,ads:L}=k(),{countryCode:j,language:T,t:h}=B(),A=v.useRef(null),g=f||"ar",r=p.find(e=>e.slug===u&&e.enabled);v.useEffect(()=>{var e,l;if(r&&d){const s=((e=d.seo)==null?void 0:e[j||"dz"])||((l=d.seo)==null?void 0:l.default)||{siteName:"Gitut",titleSeparator:"|"},t=`${r.title} ${s.titleSeparator} ${s.siteName}`,a=r.content&&(r.content[g]||Object.values(r.content)[0])||"",o=a.replace(/<[^>]*>/g,"").substring(0,160)+(a.length>160?"...":""),c="https://datas.gitut.com/data/image/gitut-og-main.png",b=T==="ar"?"ar_AR":T==="fr"?"fr_FR":"en_US";document.title=t,i("description",o,!1),i("og:title",t),i("og:description",o),i("og:image",c),i("og:image:secure_url",c),i("og:image:width","1200"),i("og:image:height","630"),i("og:url",window.location.href),i("og:type","article"),i("og:site_name",s.siteName),i("og:locale",b),i("twitter:card","summary_large_image",!1),i("twitter:url",window.location.href,!1),i("twitter:title",t,!1),i("twitter:description",o,!1),i("twitter:image",c,!1)}},[r,d,j,g,T]);const y=(r==null?void 0:r.content)&&(r.content[g]||Object.values(r.content)[0])||"",O=e=>`
            <a href="${e.link}" target="_blank" rel="noopener noreferrer" class="block rounded-lg overflow-hidden shadow-md hover:shadow-lg transition-shadow duration-300 group my-6 no-underline">
              <div class="relative">
                <img src="${e.imageUrl}" alt="${e.title}" class="w-full h-auto object-cover" />
                <div class="absolute inset-0 bg-gradient-to-t from-black/70 to-transparent p-4 flex flex-col justify-end">
                  <h3 class="text-lg font-bold text-white group-hover:underline">${e.title}</h3>
                  <p class="text-sm text-white/90">${e.content}</p>
                </div>
              </div>
            </a>
        `;v.useEffect(()=>{const e=A.current;if(!e)return;e.querySelectorAll(".injected-ad").forEach(t=>t.remove());const l=L.find(t=>t.placement==="BLOG_POST_BODY_TOP"&&t.enabled),s=L.find(t=>t.placement==="BLOG_POST_BODY_BOTTOM"&&t.enabled);if(l){const t=e.querySelector(".prose > p");if(t){const a=document.createElement("div");a.className="injected-ad",a.innerHTML=O(l),t.insertAdjacentElement("afterend",a)}}if(s){const t=e.querySelectorAll(".prose > p");if(t.length>1){const a=t[t.length-1],o=document.createElement("div");o.className="injected-ad",o.innerHTML=O(s),a.insertAdjacentElement("beforebegin",o)}}},[y,L]);const N=v.useMemo(()=>{if(!r||!r.tags||p.length<=1)return[];const e=r.tags.split(",").map(s=>S(s.trim())).filter(Boolean);if(e.length===0)return[];const l=s=>{const t=s.publishedAt||s.createdAt;return t?t.toDate?t.toDate():new Date(t):new Date(0)};return p.filter(s=>s.id===r.id||!s.enabled||!(s.content&&(s.content[g]||Object.keys(s.content).length>0))||!s.tags?!1:s.tags.split(",").map(o=>S(o.trim())).some(o=>e.includes(o))).sort((s,t)=>{const a=s.tags.split(",").map(m=>S(m.trim())),o=t.tags.split(",").map(m=>S(m.trim())),c=a.filter(m=>e.includes(m)).length,b=o.filter(m=>e.includes(m)).length;return c!==b?b-c:l(t).getTime()-l(s).getTime()}).slice(0,5)},[r,p,g]);if(v.useEffect(()=>{const e=A.current;if(!e||!j)return;const l=e.querySelectorAll("a"),s=[];return l.forEach(t=>{const a=t.getAttribute("href");if(a&&(a.startsWith("http://")||a.startsWith("https://")))try{if(new URL(a).origin!==window.location.origin){const c=b=>{b.preventDefault(),x(`/${j}/go-to-site/external`,{state:{targetUrl:a}})};t.addEventListener("click",c),s.push({link:t,handler:c})}}catch(o){console.warn(`Invalid URL found in blog post: ${a}`,o)}}),()=>{s.forEach(({link:t,handler:a})=>{t.removeEventListener("click",a)})}},[y,j,x]),!r)return n.jsxs("div",{className:"text-center py-20",children:[n.jsx("h2",{className:"text-3xl font-bold mb-4",children:h("blogPost.notFoundTitle")}),n.jsx("p",{className:"text-gray-600 mb-6",children:h("blogPost.notFoundMessage")}),n.jsx(D,{to:"/blog/",className:"bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700 transition-colors",children:h("blogPost.backToBlog")})]});const w=r.publishedAt||r.createdAt;let $="Invalid Date";if(w){const e=w.toDate?w.toDate():new Date(w);isNaN(e.getTime())||($=e.toLocaleDateString("ar-DZ"))}return n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"max-w-6xl mx-auto grid grid-cols-1 md:grid-cols-4 gap-8",children:[n.jsxs("article",{ref:A,className:"md:col-span-3 bg-white rounded-lg shadow-xl p-6 md:p-10",children:[n.jsxs("header",{className:"mb-8 border-b pb-6",children:[n.jsx("h1",{className:"text-4xl md:text-5xl font-bold text-gray-900 leading-tight",children:r.title}),n.jsxs("div",{className:"mt-4 text-sm text-gray-500",children:[n.jsxs("span",{children:[h("blogPost.publishedOn")," ",$]}),n.jsx("span",{className:"mx-2",children:"|"}),n.jsxs("span",{children:[h("blogPost.by")," ",r.author]})]})]}),n.jsx("div",{className:"prose prose-lg max-w-none text-gray-800 leading-relaxed",dangerouslySetInnerHTML:{__html:y}}),N.length>0&&n.jsxs("section",{className:"mt-12 border-t pt-8",children:[n.jsx("h3",{className:"text-2xl font-bold text-gray-800 mb-6",children:h("blogPost.relatedArticles")}),n.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6",children:N.map(e=>{const l=Object.keys(e.content||{}),s=l.includes(g)?g:l.includes("ar")?"ar":l[0],t=s&&s!=="ar"?`/blog/${s}/${e.slug}/`:`/blog/${e.slug}/`,a=e.publishedAt||e.createdAt;let o="";if(a){const m=a.toDate?a.toDate():new Date(a);isNaN(m.getTime())||(o=m.toLocaleDateString("ar-DZ",{year:"numeric",month:"long",day:"numeric"}))}const c=e.content&&(e.content[g]||Object.values(e.content)[0])||"",b=c.replace(/<[^>]*>/g,"").substring(0,80)+(c.length>80?"...":"");return n.jsxs(D,{to:t,className:"block p-4 bg-gray-50 rounded-lg border hover:border-green-400 hover:bg-green-50 transition-all group",children:[n.jsx("p",{className:"text-sm text-gray-500 mb-1",children:o}),n.jsx("p",{className:"font-bold text-lg text-gray-900 group-hover:text-green-600",children:e.title}),n.jsx("p",{className:"text-sm text-gray-600 mt-2 line-clamp-2",children:b})]},e.id)})})]}),n.jsx("footer",{className:"mt-10 border-t pt-6",children:n.jsxs(D,{to:f?`/blog/${f}/`:"/blog/",className:"text-green-600 hover:underline",children:["← ",h("blogPost.backToList")]})})]}),n.jsx("aside",{className:"md:col-span-1 space-y-6",children:N.length>0&&n.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-lg border sticky top-24",children:[n.jsx("h3",{className:"font-bold text-lg mb-3 text-gray-800 border-b pb-2",children:h("blogPost.relatedPostsSidebar")}),n.jsx("div",{className:"space-y-3",children:N.map(e=>{const l=Object.keys(e.content||{}),s=l.includes(g)?g:l.includes("ar")?"ar":l[0],t=s&&s!=="ar"?`/blog/${s}/${e.slug}/`:`/blog/${e.slug}/`,a=e.publishedAt||e.createdAt;let o="";if(a){const c=a.toDate?a.toDate():new Date(a);isNaN(c.getTime())||(o=c.toLocaleDateString("ar-DZ",{year:"numeric",month:"short",day:"numeric"}))}return n.jsxs(D,{to:t,className:"block p-3 bg-gray-50 rounded-md border hover:border-green-400 hover:bg-green-50 transition-all",children:[n.jsx("p",{className:"font-semibold text-gray-900 line-clamp-2",children:e.title}),n.jsx("p",{className:"text-xs text-gray-500 mt-1",children:o})]},e.id)})}),n.jsx("div",{className:"mt-4 pt-4 border-t",children:n.jsx(R,{placement:"BLOG_POST_SIDEBAR"})})]})})]}),n.jsx(C,{url:window.location.href,title:r.title,description:y})]})};export{P as default};
