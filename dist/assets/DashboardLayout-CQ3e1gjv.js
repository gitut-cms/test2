import{o as g,u as v,p as $,j as e,X as c,Y as C,Z as z,D as E,r as x,_ as N,$ as F,a0 as I,l as y,F as k,B as L,n as D,R as B,a1 as P,c as V,a2 as W,L as R,a3 as H}from"./index-DgmZNK3x.js";const b=()=>{const{user:t}=g(),{cafes:o}=v(),{useCafeChatManager:d}=$(),{totalUnreadCount:i}=d(),r=o.find(s=>s.id===(t==null?void 0:t.cafeId)),a="flex items-center gap-3 px-4 py-3 rounded-lg transition-colors",n="bg-green-600 text-white",l="text-gray-600 hover:bg-green-100 hover:text-green-800";return e.jsxs("aside",{className:"w-64 bg-white shadow-md flex flex-col p-4 rounded-lg",children:[e.jsxs("div",{className:"text-center border-b pb-4 mb-4",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-800",children:(r==null?void 0:r.name)||"اسم المقهى"}),e.jsx("p",{className:"text-sm text-gray-500",children:t==null?void 0:t.email})]}),e.jsxs("nav",{className:"flex flex-col gap-2",children:[e.jsxs(c,{to:"",end:!0,className:({isActive:s})=>`${a} ${s?n:l}`,children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})}),e.jsx("span",{children:"نظرة عامة"})]}),e.jsxs(c,{to:"pending-jobs",className:({isActive:s})=>`${a} ${s?n:l}`,children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("span",{children:"طلبات الزبائن"})]}),e.jsx(c,{to:"chat",className:({isActive:s})=>`${a} ${s?n:l}`,children:e.jsxs("div",{className:"flex justify-between items-center w-full",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(C,{className:"h-5 w-5"}),e.jsx("span",{children:"الدردشة"})]}),i>0&&e.jsx("span",{className:"bg-red-500 text-white text-xs font-bold rounded-full h-5 w-5 flex items-center justify-center",children:i})]})}),e.jsxs(c,{to:"generate",className:({isActive:s})=>`${a} ${s?n:l}`,children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),e.jsx("span",{children:"إنشاء مستند"})]}),e.jsxs(c,{to:"excel-studio",className:({isActive:s})=>`${a} ${s?n:l}`,children:[e.jsx(z,{className:"h-5 w-5"}),e.jsx("span",{children:"استوديو اكسل"})]}),e.jsxs(c,{to:"document-studio",className:({isActive:s})=>`${a} ${s?n:l}`,children:[e.jsx(E,{className:"h-5 w-5"}),e.jsx("span",{children:"استوديو المستندات"})]}),e.jsxs(c,{to:"multi-person-job",className:({isActive:s})=>`${a} ${s?n:l}`,children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),e.jsx("span",{children:"مهام متعددة الأشخاص"})]}),e.jsxs(c,{to:"clients",className:({isActive:s})=>`${a} ${s?n:l}`,children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),e.jsx("span",{children:"إدارة الزبائن"})]}),e.jsxs(c,{to:"settings",className:({isActive:s})=>`${a} ${s?n:l}`,children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0 3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826 3.31 2.37-2.37.996.608 2.296.096 2.572-1.065z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),e.jsx("span",{children:"الإعدادات"})]}),e.jsxs(c,{to:"billing",className:({isActive:s})=>`${a} ${s?n:l}`,children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"})}),e.jsx("span",{children:"الفواتير والاشتراك"})]})]})]})},G=()=>{const{user:t,resendVerificationEmail:o}=g(),[d,i]=x.useState(!1),[r,a]=x.useState(""),[n,l]=x.useState(!1),s=async()=>{l(!0),a("");try{await o(),i(!0),setTimeout(()=>i(!1),5e3)}catch(m){a(m.message||"Failed to send email.")}l(!1)};return!t||t.emailVerified?null:e.jsxs("div",{className:"bg-yellow-100 border-l-4 border-yellow-500 text-yellow-700 p-4 rounded-md shadow-md",role:"alert",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(N,{className:"h-6 w-6 mr-3"}),e.jsxs("div",{className:"flex-grow",children:[e.jsx("p",{className:"font-bold",children:"يرجى التحقق من بريدك الإلكتروني"}),e.jsxs("p",{className:"text-sm",children:["لم يتم التحقق من حسابك بعد. يرجى النقر على الرابط الذي أرسلناه إلى ",e.jsx("strong",{className:"font-mono",children:t.email}),"."]})]}),d?e.jsxs("div",{className:"flex items-center text-green-600 ml-auto flex-shrink-0",children:[e.jsx(F,{className:"mr-2"}),e.jsx("span",{className:"font-semibold",children:"تم الإرسال!"})]}):e.jsx("button",{onClick:s,disabled:n,className:"ml-auto flex-shrink-0 bg-yellow-500 text-white font-bold py-2 px-4 rounded-lg hover:bg-yellow-600 transition-colors disabled:opacity-50",children:n?"جاري الإرسال...":"إعادة إرسال البريد الإلكتروني"})]}),r&&e.jsx("p",{className:"text-red-600 text-sm mt-2",children:r})]})},T=()=>{const{isOfflineReady:t,isSyncing:o,syncProgress:d,syncError:i,startSync:r}=I(),[a,n]=x.useState(sessionStorage.getItem("offlineSyncDismissed")==="true"),l=()=>{sessionStorage.setItem("offlineSyncDismissed","true"),n(!0)};return t||a?null:e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 z-[100] flex justify-center items-center p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-lg text-center p-8 space-y-4 relative",children:[e.jsx("button",{onClick:l,className:"absolute top-3 right-3 text-gray-400 hover:text-gray-600 p-2","aria-label":"إغلاق",children:e.jsx(y,{size:20})}),e.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"تفعيل وضع عدم الاتصال"}),e.jsx("p",{className:"text-gray-600",children:"لضمان أفضل أداء وسرعة، يمكنك تحميل بيانات التطبيق الأساسية للعمل دون اتصال بالإنترنت. هذه العملية تتم مرة واحدة فقط."}),o?e.jsxs("div",{className:"space-y-3 pt-4",children:[e.jsx(k,{className:"animate-spin text-4xl text-green-600 mx-auto"}),e.jsx("p",{className:"font-semibold text-green-700",children:d||"جاري المزامنة..."})]}):e.jsxs("div",{className:"pt-4",children:[i&&e.jsxs("div",{className:"bg-red-100 text-red-700 p-3 rounded-md mb-4 flex items-center text-right gap-2",children:[e.jsx(N,{className:"flex-shrink-0"}),e.jsxs("span",{children:["خطأ: ",i]})]}),e.jsxs("button",{onClick:r,className:"w-full flex items-center justify-center gap-3 bg-green-600 text-white font-bold py-3 px-6 rounded-lg hover:bg-green-700 transition-colors",children:[e.jsx(L,{}),e.jsx("span",{children:i?"المحاولة مرة أخرى":"تحميل البيانات للعمل دون اتصال"})]})]})]})})},O=()=>{const[t,o]=x.useState(!0),d=()=>{sessionStorage.setItem("extensionNotificationDismissed","true"),o(!1)};return t?e.jsxs("div",{className:"bg-blue-100 border-l-4 border-blue-500 text-blue-800 p-4 rounded-md shadow-md relative mb-6 animate-fadeIn",role:"alert",children:[e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"py-1",children:e.jsx(L,{className:"h-6 w-6 text-blue-500 ml-4 rtl:ml-0 rtl:mr-4"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold",children:"هل تريد ملء البيانات تلقائياً؟"}),e.jsxs("p",{className:"text-sm",children:["للاستفادة من خدمة ملء البيانات التلقائية، يجب تحميل الإضافة الخاصة بنا.",e.jsx("a",{href:"https://files.gitut.com/data/add-on/gitut.zip",target:"_blank",rel:"noopener noreferrer",className:"font-semibold underline mr-2 rtl:mr-0 rtl:ml-2 hover:text-blue-600",children:"اضغط هنا للتحميل"}),"."]})]})]}),e.jsx("button",{onClick:d,className:"absolute top-0 bottom-0 left-0 px-4 py-3 rtl:left-auto rtl:right-0","aria-label":"إغلاق",children:e.jsx(y,{className:"h-5 w-5 text-blue-500 hover:text-blue-700"})})]}):null},U=()=>{const{t}=V();return e.jsx("div",{className:"flex items-center justify-center h-full min-h-[50vh]",children:e.jsxs("div",{className:"max-w-2xl text-center p-8",children:[e.jsx(W,{className:"text-5xl text-yellow-500 mx-auto mb-4"}),e.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:t("dashboardLayout.unpublishedGate.title")}),e.jsx("p",{className:"text-gray-600 mb-6",children:t("dashboardLayout.unpublishedGate.message")}),e.jsxs(R,{to:"settings",className:"inline-flex items-center justify-center gap-2 bg-green-600 text-white font-bold py-3 px-8 rounded-lg hover:bg-green-700 transition-colors text-lg",children:[e.jsx(H,{}),e.jsx("span",{children:t("dashboardLayout.unpublishedGate.button")})]})]})})},A=()=>{const{loadFullDocuments:t,cafes:o,loading:d}=v(),{user:i,refetchUser:r}=g(),a=D(),n=a.pathname.includes("document-studio")||a.pathname.includes("excel-studio"),l=a.pathname.endsWith("/settings"),[s,m]=x.useState(!1),f=B.useMemo(()=>o.find(h=>h.id===(i==null?void 0:i.cafeId)),[o,i]);x.useEffect(()=>{t()},[t]),x.useEffect(()=>{r()},[r]),x.useEffect(()=>{let h=!1;const j=u=>{var p,w;u.source===window&&((p=u.data)==null?void 0:p.source)==="gitut-extension"&&((w=u.data)==null?void 0:w.type)==="pong"&&(h=!0,m(!1),window.removeEventListener("message",j))};window.addEventListener("message",j),window.postMessage({source:"gitut-webapp",type:"ping"},"*");const M=setTimeout(()=>{h||sessionStorage.getItem("extensionNotificationDismissed")||m(!0)},1500);return()=>{clearTimeout(M),window.removeEventListener("message",j)}},[]);const S=f&&!f.isProfilePublished&&!l;return d?e.jsxs("div",{className:"flex flex-col md:flex-row gap-8 items-start",children:[e.jsx(b,{}),e.jsx("main",{className:"flex-1 w-full flex items-center justify-center p-10 h-[60vh]",children:e.jsx(k,{className:"animate-spin text-4xl text-green-600"})})]}):e.jsxs(e.Fragment,{children:[e.jsx(T,{}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-8 items-start",children:[e.jsx(b,{}),e.jsxs("main",{className:"flex-1 w-full space-y-6",children:[s&&e.jsx(O,{}),e.jsx(G,{}),e.jsx("div",{className:`bg-white rounded-lg shadow-lg ${n?"p-0 h-[85vh] overflow-hidden":"p-6 min-h-[60vh]"}`,children:S?e.jsx(U,{}):e.jsx(P,{})})]})]})]})};export{A as default};
