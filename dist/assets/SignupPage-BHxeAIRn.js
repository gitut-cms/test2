import{u as be,c as fe,a as ye,n as we,C as M,r,o as je,j as e,L as V}from"./index-DgmZNK3x.js";const Ne=["gmail.com","outlook.com","hotmail.com","live.com"],Se=()=>{const{wilayas:x,dairas:R,communes:U,locationsLoading:S}=be(),{t,countryCode:m,language:z}=fe(),H=ye(),k=we(),d=M[z],T=M.en.map(s=>({code:s.code,name:s.name,flag:s.flag,phoneCode:s.phoneCode})).sort((s,o)=>s.name.localeCompare(o.name)),n=k.state||{},[c,Z]=r.useState(n.email||""),[u,J]=r.useState(n.password||""),[b,K]=r.useState(n.confirmPassword||""),[f,Q]=r.useState(n.cafeName||""),[y,X]=r.useState(n.ownerName||""),[g,Y]=r.useState(n.street||""),[h,ee]=r.useState(()=>d.find(s=>s.code===m)||d[0]),[l,se]=r.useState(n.selectedWilaya||""),[p,A]=r.useState(n.selectedDaira||""),[w,F]=r.useState(n.selectedCommune||""),[j,te]=r.useState(n.genericState||""),[N,re]=r.useState(n.genericCity||""),[v,oe]=r.useState(n.phone||""),[q,D]=r.useState(h.phoneCode),[ne,E]=r.useState([]),[ae,C]=r.useState([]),[I,i]=r.useState(""),[O,_]=r.useState(!1),[le,ie]=r.useState(!1),{signup:de}=je();r.useEffect(()=>{if(!k.state){const s=d.find(o=>o.code===m)||d[0];ee(s),D(s.phoneCode)}},[m,d,k.state]);const ce=s=>{const o=s.target.value,a=d.find($=>$.code===o);a&&D(a.phoneCode);const W={email:c,password:u,confirmPassword:b,cafeName:f,ownerName:y,street:g,selectedWilaya:l,selectedDaira:p,selectedCommune:w,genericState:j,genericCity:N,phone:v};H(`/${o}/signup`,{replace:!0,state:W})},ue=s=>{const o=s.target.value;se(o),A(""),F(""),o?(E(R.filter(a=>a.wilaya_code===o)),C([])):(E([]),C([]))},me=s=>{const o=s.target.value;A(o),F(""),C(o&&l?U.filter(a=>a.daira_name===o&&a.wilaya_code===l):[])},ge=async s=>{var G;s.preventDefault(),i("");const o=c.split("@")[1];if(!Ne.includes(o)){i(t("signup.errors.allowedDomains"));return}const a=x.length>0;if(!c||!u||!b||!f||!y||!g||!(a&&l&&p&&w)&&!(!a&&j&&N)){i(t("signup.errors.fillAllFields"));return}if(u!==b){i(t("signup.errors.passwordsMismatch"));return}if(u.length<6){i(t("signup.errors.passwordLength"));return}_(!0);let P;a?P={wilaya:((G=x.find(xe=>xe.code===l))==null?void 0:G.name)||"",wilaya_code:l,daira:p,commune:w,street:g}:P={state:j,city:N,street:g};const he=h.code==="dz"?{amount:200,currency:"DZD"}:{amount:1,currency:"USD"};let B="";v&&(B=`${q} ${v}`);const pe={name:f,owner:y,countryCode:h.code,countryPhoneCode:h.phoneCode,address:P,initialCredits:he,phone:B};try{await de(c,u,pe)?ie(!0):i(t("signup.errors.signupFailed"))}catch(L){L.code==="auth/email-already-in-use"?i("هذا البريد الإلكتروني مستخدم بالفعل. يرجى استخدام بريد إلكتروني آخر أو تسجيل الدخول."):i(t("signup.errors.signupFailed"))}finally{_(!1)}};return le?e.jsx("div",{className:"max-w-lg mx-auto mt-10",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-8 text-center",children:[e.jsx("svg",{className:"w-16 h-16 text-green-500 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:t("signup.success.title")}),e.jsxs("p",{className:"text-gray-600 mb-6",children:[t("signup.success.message")," ",e.jsx("strong",{className:"font-semibold",children:c}),".",t("signup.success.instruction")]}),e.jsx(V,{to:`/${m}/login`,className:"w-full bg-green-600 text-white p-3 rounded-lg font-bold hover:bg-green-700 transition-colors inline-block",children:t("signup.success.loginButton")})]})}):e.jsx("div",{className:"max-w-lg mx-auto mt-10",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-center text-gray-900 mb-6",children:t("signup.title")}),I&&e.jsx("p",{className:"bg-red-100 text-red-700 p-3 rounded-md mb-4 text-center",children:I}),e.jsxs("form",{onSubmit:ge,className:"space-y-6",children:[e.jsxs("fieldset",{className:"space-y-4 border p-4 rounded-md",children:[e.jsx("legend",{className:"px-2 font-semibold text-gray-700",children:t("signup.accountInfo")}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email-signup",className:"block text-sm font-medium text-gray-700 mb-1",children:t("signup.email")}),e.jsx("input",{type:"email",id:"email-signup",value:c,onChange:s=>Z(s.target.value),required:!0,className:"block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-green-500 focus:border-green-500",placeholder:"user@gmail.com / user@outlook.com"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password-signup",className:"block text-sm font-medium text-gray-700 mb-1",children:t("signup.password")}),e.jsx("input",{type:"password",id:"password-signup",value:u,onChange:s=>J(s.target.value),required:!0,className:"block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-green-500 focus:border-green-500",placeholder:t("signup.passwordPlaceholder")})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"confirm-password",className:"block text-sm font-medium text-gray-700 mb-1",children:t("signup.confirmPassword")}),e.jsx("input",{type:"password",id:"confirm-password",value:b,onChange:s=>K(s.target.value),required:!0,className:"block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-green-500 focus:border-green-500",placeholder:"********"})]})]}),e.jsxs("fieldset",{className:"space-y-4 border p-4 rounded-md",children:[e.jsx("legend",{className:"px-2 font-semibold text-gray-700",children:t("signup.cafeInfo")}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"cafeName",className:"block text-sm font-medium text-gray-700 mb-1",children:t("signup.cafeName")}),e.jsx("input",{type:"text",id:"cafeName",value:f,onChange:s=>Q(s.target.value),required:!0,className:"block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-green-500 focus:border-green-500",placeholder:t("signup.cafeNamePlaceholder")})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"ownerName",className:"block text-sm font-medium text-gray-700 mb-1",children:t("signup.ownerName")}),e.jsx("input",{type:"text",id:"ownerName",value:y,onChange:s=>X(s.target.value),required:!0,className:"block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-green-500 focus:border-green-500",placeholder:t("signup.ownerNamePlaceholder")})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"country",className:"block text-sm font-medium text-gray-700 mb-1",children:t("signup.country")}),e.jsx("select",{id:"country",value:h.code,onChange:ce,required:!0,className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm bg-white focus:outline-none focus:ring-green-500 focus:border-green-500",children:d.map(s=>e.jsx("option",{value:s.code,children:s.name},s.code))})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"phone",className:"block text-sm font-medium text-gray-700 mb-1",children:[t("formFields.phone")||"رقم الهاتف / واتساب"," (اختياري)"]}),e.jsxs("div",{className:"flex",dir:"ltr",children:[e.jsx("select",{value:q,onChange:s=>D(s.target.value),className:"block w-28 px-2 py-2 border border-gray-300 rounded-l-md shadow-sm bg-gray-50 focus:outline-none focus:ring-green-500 focus:border-green-500 text-sm border-r-0",children:T.map(s=>e.jsxs("option",{value:s.phoneCode,children:[s.flag," ",s.phoneCode]},s.code))}),e.jsx("input",{type:"tel",id:"phone",value:v,onChange:s=>oe(s.target.value),className:"block w-full px-3 py-2 bg-white border border-gray-300 rounded-r-md shadow-sm focus:outline-none focus:ring-green-500 focus:border-green-500",placeholder:"551234567"})]})]}),x.length>0?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"wilaya",className:"block text-sm font-medium text-gray-700 mb-1",children:t("signup.wilaya")}),e.jsxs("select",{id:"wilaya",value:l,onChange:ue,required:!0,disabled:S,className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm bg-white focus:outline-none focus:ring-green-500 focus:border-green-500",children:[e.jsx("option",{value:"",children:t(S?"signup.loading":"signup.selectWilaya")}),x.map(s=>e.jsx("option",{value:s.code,children:s.name},s.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"daira",className:"block text-sm font-medium text-gray-700 mb-1",children:t("signup.daira")}),e.jsxs("select",{id:"daira",value:p,onChange:me,required:!0,disabled:!l,className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm bg-white focus:outline-none focus:ring-green-500 focus:border-green-500",children:[e.jsx("option",{value:"",children:t("signup.selectDaira")}),ne.map(s=>e.jsx("option",{value:s.name,children:s.name},s.id))]})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"commune",className:"block text-sm font-medium text-gray-700 mb-1",children:t("signup.commune")}),e.jsxs("select",{id:"commune",value:w,onChange:s=>F(s.target.value),required:!0,disabled:!p,className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm bg-white focus:outline-none focus:ring-green-500 focus:border-green-500",children:[e.jsx("option",{value:"",children:t("signup.selectCommune")}),ae.map(s=>e.jsx("option",{value:s.name,children:s.name},s.id))]})]})]}):e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"genericState",className:"block text-sm font-medium text-gray-700 mb-1",children:t("signup.state")}),e.jsx("input",{type:"text",id:"genericState",value:j,onChange:s=>te(s.target.value),required:!0,className:"block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-green-500 focus:border-green-500",placeholder:t("signup.statePlaceholder")})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"genericCity",className:"block text-sm font-medium text-gray-700 mb-1",children:t("signup.city")}),e.jsx("input",{type:"text",id:"genericCity",value:N,onChange:s=>re(s.target.value),required:!0,className:"block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-green-500 focus:border-green-500",placeholder:t("signup.cityPlaceholder")})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"street",className:"block text-sm font-medium text-gray-700 mb-1",children:t("signup.street")}),e.jsx("input",{type:"text",id:"street",value:g,onChange:s=>Y(s.target.value),required:!0,className:"block w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-green-500 focus:border-green-500",placeholder:t("signup.streetPlaceholder")})]})]}),e.jsx("button",{type:"submit",disabled:O||S,className:"w-full bg-green-600 text-white p-3 rounded-lg font-bold hover:bg-green-700 transition-colors disabled:bg-gray-400",children:t(O?"signup.creatingButton":"signup.createButton")})]}),e.jsxs("p",{className:"text-center text-gray-600 mt-6",children:[t("signup.haveAccount")," ",e.jsx(V,{to:`/${m}/login`,className:"text-green-600 hover:underline font-semibold",children:t("signup.loginHere")})]})]})})};export{Se as default};
