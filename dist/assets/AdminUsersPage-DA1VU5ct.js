import{r as i,a as N,b as v,p as y,bc as C,j as e,i as A,aH as S,be as U}from"./index-DrB1YgVl.js";import"https://esm.sh/html-docx-js-typescript@0.1.5";import"https://esm.sh/file-saver@2.0.5";const w=()=>{const[x,d]=i.useState([]),{cafes:o,loading:m}=N(),{useAdminChatManager:h}=v(),{onlineCafeIds:p,selectConversation:g}=h(),[j,r]=i.useState(!0),f=y();i.useEffect(()=>{r(!0),C().then(d).finally(()=>r(!1))},[]);const c=(s,t)=>{let a="";t==="Suspended"&&(a=prompt("يرجى إدخال سبب تعليق الحساب:")||"لا يوجد سبب محدد."),d(n=>n.map(l=>l.id===s?{...l,status:t,suspensionReason:t==="Suspended"?a:void 0}:l))},b=s=>{switch(s){case"Active":return e.jsx("span",{className:"px-3 py-1 text-xs font-semibold text-green-800 bg-green-200 rounded-full",children:"نشط"});case"Suspended":return e.jsx("span",{className:"px-3 py-1 text-xs font-semibold text-red-800 bg-red-200 rounded-full",children:"معلّق"})}},u=s=>{g(s),f("/admin/app/chat")};return m||j?e.jsx("div",{className:"flex justify-center items-center p-10",children:e.jsx(A,{className:"animate-spin text-4xl text-green-600"})}):e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-6",children:"إدارة المستخدمين"}),e.jsx("div",{className:"bg-white p-2 rounded-lg border shadow-sm",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-right",children:[e.jsx("thead",{className:"bg-gray-50 border-b",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-3 font-semibold text-sm text-gray-600",children:"اسم المقهى"}),e.jsx("th",{className:"p-3 font-semibold text-sm text-gray-600",children:"الاتصال"}),e.jsx("th",{className:"p-3 font-semibold text-sm text-gray-600",children:"البريد الإلكتروني"}),e.jsx("th",{className:"p-3 font-semibold text-sm text-gray-600",children:"الحالة"}),e.jsx("th",{className:"p-3 font-semibold text-sm text-gray-600",children:"إجراءات"})]})}),e.jsx("tbody",{children:x.map(s=>{const t=o.find(n=>n.id===s.cafeId),a=p.has(s.cafeId);return e.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[e.jsx("td",{className:"p-3 text-gray-800 font-semibold",children:(t==null?void 0:t.name)||"غير معروف"}),e.jsx("td",{className:"p-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(S,{className:`text-[10px] ${a?"text-green-500 animate-pulse":"text-gray-300"}`}),e.jsx("span",{className:"text-xs text-gray-500",children:a?"متصل":"أوفلاين"})]})}),e.jsx("td",{className:"p-3 text-gray-600 text-sm",children:s.email}),e.jsx("td",{className:"p-3",title:s.suspensionReason,children:b(s.status)}),e.jsx("td",{className:"p-3",children:e.jsxs("div",{className:"flex items-center gap-4",children:[s.status==="Active"?e.jsx("button",{onClick:()=>c(s.id,"Suspended"),className:"text-red-600 hover:underline text-sm font-semibold",children:"تعليق"}):e.jsx("button",{onClick:()=>c(s.id,"Active"),className:"text-green-600 hover:underline text-sm font-semibold",children:"تفعيل"}),e.jsxs("button",{onClick:()=>u(s.cafeId),className:"flex items-center gap-1 text-blue-600 hover:text-blue-800 text-sm font-bold",title:"بدء دردشة دعم",children:[e.jsx(U,{})," ",e.jsx("span",{children:"دردشة"})]})]})})]},s.id)})})]})})})]})};export{w as default};
